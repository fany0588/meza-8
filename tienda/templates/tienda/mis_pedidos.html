{% extends "tienda/base.html" %}

{% block title %}Mis Pedidos - FashionStyle{% endblock %}

{% block content %}
<div class="container">
    <h1>Mis Pedidos</h1>
    
    {% if pedidos %}
        <div style="display: flex; flex-direction: column; gap: 20px;">
            {% for pedido in pedidos %}
            <div style="border: 1px solid #ddd; border-radius: 10px; padding: 20px; background: white;">
                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
                    <div>
                        <h3 style="margin: 0 0 5px 0; color: #e91e63;">
                            Pedido #{{ pedido.id }}
                        </h3>
                        <p style="margin: 0; color: #666; font-size: 0.9rem;">
                            Fecha: {{ pedido.fecha_pedido|date:"d/m/Y H:i" }}
                        </p>
                    </div>
                    <div style="text-align: right;">
                        <span style="display: inline-block; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: bold;
                            {% if pedido.estado == 'entregado' %}background: #d4edda; color: #155724;
                            {% elif pedido.estado == 'enviado' %}background: #cce7ff; color: #004085;
                            {% elif pedido.estado == 'en_proceso' %}background: #fff3cd; color: #856404;
                            {% elif pedido.estado == 'cancelado' %}background: #f8d7da; color: #721c24;
                            {% else %}background: #e2e3e5; color: #383d41;{% endif %}">
                            {{ pedido.get_estado_display }}
                        </span>
                        <p style="margin: 5px 0 0 0; font-size: 1.2rem; font-weight: bold; color: #333;">
                            ${{ pedido.total }}
                        </p>
                    </div>
                </div>

                <div style="margin-bottom: 15px;">
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        <strong>Método de pago:</strong> {{ pedido.get_metodo_pago_display }}
                    </p>
                    {% if pedido.codigo_seguimiento %}
                    <p style="margin: 5px 0; font-size: 0.9rem;">
                        <strong>Código de seguimiento:</strong> {{ pedido.codigo_seguimiento }}
                    </p>
                    {% endif %}
                </div>

                <!-- Acciones -->
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <a href="#" 
                       style="background: #e91e63; color: white; padding: 8px 15px; text-decoration: none; border-radius: 5px; font-size: 0.9rem;">
                        Ver Detalles
                    </a>
                    
                    {% if pedido.estado == 'pendiente' or pedido.estado == 'confirmado' %}
                    <form method="post" action="{% url 'cancelar_pedido' pedido.id %}" style="margin: 0;">
                        {% csrf_token %}
                        <button type="submit" 
                                style="background: #dc3545; color: white; padding: 8px 15px; border: none; border-radius: 5px; font-size: 0.9rem; cursor: pointer;"
                                onclick="return confirm('¿Estás seguro de que quieres cancelar este pedido?')">
                            Cancelar Pedido
                        </button>
                    </form>
                    {% endif %}
                    
                    {% if pedido.estado == 'enviado' %}
                    <a href="#" 
                       style="background: #17a2b8; color: white; padding: 8px 15px; text-decoration: none; border-radius: 5px; font-size: 0.9rem;">
                        Rastrear Envío
                    </a>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 60px 20px; background: white; border-radius: 10px;">
            <h3 style="color: #666; margin-bottom: 15px;">No tienes pedidos aún</h3>
            <p style="color: #888; margin-bottom: 20px;">
                ¡Descubre nuestra colección y realiza tu primer pedido!
            </p>
            <a href="{% url 'todos_productos' %}" 
               style="background: #e91e63; color: white; padding: 12px 25px; text-decoration: none; border-radius: 5px; font-size: 1rem;">
                Comprar Ahora
            </a>
        </div>
    {% endif %}
</div>
{% endblock %}